parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"HPsM":[function(require,module,exports) {
function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(e)}function e(n,e){var t="undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=i(n))||e&&n&&"number"==typeof n.length){t&&(n=t);var o=0,r=function(){};return{s:r,n:function(){return o>=n.length?{done:!0}:{done:!1,value:n[o++]}},e:function(n){throw n},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,l=!1;return{s:function(){t=t.call(n)},n:function(){var n=t.next();return c=n.done,n},e:function(n){l=!0,a=n},f:function(){try{c||null==t.return||t.return()}finally{if(l)throw a}}}}function t(n){return a(n)||r(n)||i(n)||o()}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function i(n,e){if(n){if("string"==typeof n)return c(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);return"Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t?Array.from(n):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?c(n,e):void 0}}function r(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}function a(n){if(Array.isArray(n))return c(n)}function c(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,o=new Array(e);t<e;t++)o[t]=n[t];return o}function l(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})),t.push.apply(t,o)}return t}function s(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?l(Object(t),!0).forEach(function(e){d(n,e,t[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))})}return n}function d(n,e,t){return(e=u(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function u(e){var t=p(e,"string");return"symbol"==n(t)?t:t+""}function p(e,t){if("object"!=n(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var i=o.call(e,t||"default");if("object"!=n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}!function(){window.PegglePrime&&window.PegglePrime.stop();var n=Math.PI/180,o=function(e,t,o){var i=o*Math.sin(t*n),r=o*Math.cos(t*n);return{x:e.x+(Math.abs(i)<1e-4?0:i),y:e.y-(Math.abs(r)<1e-4?0:r)}};function i(n,e){return n.x*e.x+n.y*e.y}var r={lastTick:void 0,cannon:{origin:{x:0,y:0},length:50,angle:0,muzzleVelocity:750,canMove:!0},player:{effects:[],balls:10},board:{width:660,height:680,ballRadius:10,pieceRadius:14,gravity:-900,balls:[],configuration:{pieceValues:{GOAL:100,BONUS:1e3,POINT:25,POWER:100}},pieces:[{type:"GOAL",isVisible:!0,isHit:!1,position:{x:-100,y:0}},{type:"POINT",isVisible:!0,isHit:!1,position:{x:-50,y:-50}},{type:"BONUS",isVisible:!0,isHit:!1,position:{x:100,y:0}},{type:"POWER",isVisible:!0,isHit:!1,position:{x:50,y:-50}}]}},a={playerActions:[{action:"AIM",description:"Adjust the direction the ball is launched",defaultMapping:"MOUSE_MOVE"},{action:"SHOOT",description:"Launch the ball from the cannon",defaultMapping:"MOUSE_LCLICK"},{action:"TOGGLE_AIM",description:"Toggle aiming movement",defaultMapping:"MOUSE_RCLICK"}],apply:function(i,r){var a=this,c=r.name,l=r.payload;switch(c){case"AIM":var d=i.cannon,u=d.canMove,p=d.origin;if(!u)return i;var b=p.x-l.x,y=p.y-Math.min(p.y,l.y);return s(s({},i),{},{cannon:s(s({},i.cannon),{},{angle:Math.atan2(y,b)/n-90})});case"SHOOT":if(!i.player.balls||i.board.balls.length)return i;var h=i.cannon,f=h.origin,g=h.angle,v=h.length,m=h.muzzleVelocity,x={position:s({},o(f,g,v)),velocity:s({},o({x:0,y:0},g,m))};return s(s({},i),{},{player:s({},i.player),board:s(s({},i.board),{},{balls:[].concat(t(i.board.balls),[x])})});case"TOGGLE_AIM":var w=i.cannon.canMove;return s(s({},i),{},{cannon:s(s({},i.cannon),{},{canMove:!w})});case"TICK":var O=i.board,S=O.gravity,M=O.height,L=O.width,T=O.ballRadius,A=O.pieces,P=l.delta,E={bottom:-M/2,left:-L/2,right:L/2},R=new Set,j=i.board.balls.map(function(n){var t=s(s({},n),{},{position:{x:n.position.x+n.velocity.x*P,y:n.position.y+n.velocity.y*P+.5*S*P*P},velocity:s(s({},n.velocity),{},{y:n.velocity.y+S*P})});if(t.position.x-T<E.left){var o=E.left-(t.position.x-T);t.position.x=E.left+o,t.velocity.x=-t.velocity.x}else if(t.position.x+T>E.right){var r=t.position.x+T-E.right;t.position.x=E.right-r,t.velocity.x=-t.velocity.x}var c,l=-1,d=e(A);try{for(d.s();!(c=d.n()).done;){var u=c.value;if(l++,u.isVisible){var p=a.collision(i,t,u,n);p&&(R.add(l),t.position=p.position,t.velocity=p.velocity)}}}catch(b){d.e(b)}finally{d.f()}return t}).filter(function(n){return!(n.position.y+T<E.bottom)});return s(s({},i),{},{board:s(s({},i.board),{},{balls:j,pieces:R.size?i.board.pieces.map(function(n,e){return R.has(e)?s(s({},n),{},{isHit:!0}):n}):i.board.pieces})});default:return console.log("Unknown action",{name:c,payload:l}),i}},collision:function(n,e,t,o,r){var a=n.board,c=a.ballRadius,l=a.pieceRadius,s=(a.gravity,c+l),d=e.position.x-t.position.x,u=e.position.y-t.position.y;if(d*d+u*u>s*s)return null;var p,b,y=(p={x:d*c/s-t.position.x,y:u*c/s-t.position.y},b=Math.sqrt(p.x*p.x+p.y*p.y),{x:p.x/b,y:p.y/b});return{position:{x:e.position.x+y.x*l,y:e.position.y+y.y*l},velocity:{x:.9*(e.velocity.x-2*y.x*i(e.velocity,y)),y:.9*(e.velocity.y-2*y.y*i(e.velocity,y))}}}},c={running:!1,lastState:{},init:function(n,e){var t=this,o=window.document.body;o.classList.toggle("game-window",!0),o.innerHTML="",this.state=n,this.autoAdjust(),this.renderStyle(),this.actionQueue=[];var i={stop:function(){return t.stop()},getState:function(){return t.state},dispatch:function(n){return t.dispatch(n)},engine:e,renderer:this};return this.running=!0,function n(){if(t.running){for(t.lastState=t.state;t.actionQueue.length;)t.state=e.apply(t.state,t.actionQueue.pop());t.gameLoop=window.requestAnimationFrame(function(i){t.state=e.apply(t.state,{name:"TICK",payload:{delta:(i-(t.lastTick||i))/1e3}}),t.lastTick=i,t.render(o),n()})}}(),i},dispatch:function(n){this.actionQueue.push(n)},stop:function(){this.running=!1},worldToBrowser:function(n){var e=this.state.board,t=e.width,o=e.height;return{x:t/2+n.x,y:o/2-n.y}},browserToWorld:function(n){var e=this.state.board,t=e.width,o=e.height;return{x:n.x-t/2,y:o/2-n.y}},autoAdjust:function(){var n=window,e=n.innerWidth-40,t=n.innerHeight-40;this.state=s(s({},this.state),{},{board:s(s({},this.state.board),{},{width:e,height:t}),cannon:s(s({},this.state.cannon),{},{origin:s(s({},this.state.cannon.origin),{},{y:t/2-5})})})},renderStyle:function(){var n=this.state,e=document.getElementById("pp-style")||document.createElement("style");e.id="pp-style",e.innerHTML="\nhtml,\n.game-window {\n  box-sizing: border-box;\n  height: 100%;\n  width: 100%;\n  margin: 0;\n  background: aliceblue;\n  position: relative;\n  overflow: hidden;\n}\n\n.board {\n  position: relative;\n  width: ".concat(n.board.width,"px;\n  height: ").concat(n.board.height,"px;\n  margin: 20px;\n  background: lightcoral;\n  overflow: hidden;\n  border-radius: 10px;\n}\n\n.score {\n  position: absolute;\n  display: inline-block;\n  right: 20px;\n  top: 5px;\n  color: white;\n  font-family: 'Helvetica Neue', Helvetica;\n  font-weight: bold;\n  font-size: 24pt;\n}\n\n.cannon {\n  position: relative;\n  background: purple;\n  height: ").concat(8*n.board.ballRadius,"px;\n  width: ").concat(8*n.board.ballRadius,"px;\n  margin-top: ").concat(4*-n.board.ballRadius,"px;\n  margin-left: ").concat(4*-n.board.ballRadius,"px;\n  border-radius: 50%;\n}\n\n.cannon__barrel {\n  position: absolute;\n  background: black;\n  width: ").concat(2*n.board.ballRadius,"px;\n  height: ").concat(n.cannon.length,"px;\n  top: 50%;\n  left: calc(50% - ").concat(n.board.ballRadius,"px);\n  border-radius: ").concat(n.board.ballRadius,"px;\n}\n\n.ball {\n  position: absolute;\n  box-sizing: border-box;\n  width: ").concat(2*n.board.ballRadius,"px;\n  height: ").concat(2*n.board.ballRadius,"px;\n  margin-left: ").concat(-n.board.ballRadius,"px;\n  margin-top: ").concat(-n.board.ballRadius,"px;\n  border-radius: 50%;\n  background: grey;\n}\n\n.piece {\n  position: absolute;\n  box-sizing: border-box;\n  width: ").concat(2*n.board.pieceRadius,"px;\n  height: ").concat(2*n.board.pieceRadius,"px;\n  margin-left: ").concat(-n.board.pieceRadius,"px;\n  margin-top: ").concat(-n.board.pieceRadius,"px;\n  border-radius: 50%;\n  border: ").concat((.2*n.board.pieceRadius).toFixed(0),"px solid transparent;\n}\n\n.piece--point {\n  background-color: aqua;\n  border-color: turquoise;\n}\n\n.piece--goal {\n  background-color: darkorange;\n  border-color: orange;\n}\n\n.piece--bonus {\n  background-color: blueviolet;\n  border-color: purple;\n}\n\n.piece--power {\n  background-color: limegreen;\n  border-color: green;\n}\n\n.piece--is-hit {\n  box-shadow: lightblue 0 0 5px 3px;\n}\n          ").trim(),document.head.appendChild(e)},render:function(n){this.renderBoard(n)},renderBoard:function(n){var e=this,t=n.querySelector(".board");t||((t=document.createElement("div")).classList.add("board"),t.addEventListener("mousemove",function(n){var o=t.getBoundingClientRect(),i=o.x,r=o.y;e.actionQueue.push({name:"AIM",payload:e.browserToWorld({x:n.clientX-i,y:n.clientY-r})})}),t.addEventListener("click",function(n){e.dispatch({name:"SHOOT"})},!0),n.addEventListener("keypress",function(n){n.preventDefault(),"a"===n.key&&e.dispatch({name:"TOGGLE_AIM"})}),n.appendChild(t)),this.renderScore(t),this.renderPieces(t),this.renderCannon(t),this.renderBalls(t)},renderPieces:function(n){var e=this.state.board.pieces,t=Array.from(n.querySelectorAll(".piece"));t.length||(t=e.map(function(e,t){var o=document.createElement("div");return o.id="piece-".concat(t),o.classList.add("piece"),o.classList.add("piece--".concat(e.type.toLowerCase())),n.appendChild(o),o}));for(var o=0,i=0;o<e.length;o++){var r=e[o],a=t[o-i],c=a.id==="piece-".concat(o);if(r.isVisible||!c)if(c){a.classList.toggle("piece--is-hit",r.isHit);var l=this.worldToBrowser(r.position);a.style.left="".concat(l.x,"px"),a.style.top="".concat(l.y,"px")}else i++,o--;else a.remove()}},renderCannon:function(n){var e=n.querySelector(".cannon");if(!e){(e=document.createElement("div")).classList.add("cannon");var t=this.worldToBrowser(this.state.cannon.origin);e.style.left="".concat(t.x,"px"),e.style.top="".concat(t.y,"px");var o=document.createElement("div");o.classList.add("cannon__barrel"),e.appendChild(o),n.appendChild(e)}var i=(-this.state.cannon.angle).toFixed(2);e.style.transform="rotate(".concat(i,"deg)")},renderBalls:function(n){var e=this.state.board.balls,t=Array.from(n.querySelectorAll(".ball"));if(!e.length&&this.state.player.balls>0){var i=this.state.cannon,r=i.length,a=i.angle,c=i.origin;e=[{position:s({},o(c,a,r))}]}for(var l,d=Math.max(t.length,e.length),u=0;u<d;u++)if(u>=e.length)t[u].remove();else{var p=t[u]||(l=void 0,(l=document.createElement("div")).classList.add("ball"),n.appendChild(l),l),b=this.worldToBrowser(e[u].position);p.style.left="".concat(b.x,"px"),p.style.top="".concat(b.y,"px")}},renderScore:function(n){var e=n.querySelector(".score");e||((e=document.createElement("span")).classList.add("score"),n.appendChild(e));var t=this.state.board,o=t.configuration,i=t.pieces;if(!e.innerHTML||i!==this.lastState.board.pieces){var r=i.reduce(function(n,e){return e.isHit?n+o.pieceValues[e.type]:n},0);e.innerHTML=r}}};window.PegglePrime=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=n.state,t=void 0===e?r:e,o=n.engine,i=void 0===o?a:o,l=n.renderer;return(void 0===l?c:l).init(t,i)}(),console.log(window.PegglePrime)}();
},{}],"H99C":[function(require,module,exports) {
"use strict";require("./game");
},{"./game":"HPsM"}]},{},["H99C"], null)
//# sourceMappingURL=/src.58ae58af.js.map